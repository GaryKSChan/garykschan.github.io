<!DOCTYPE html>
<html>
<head>
  <title>BNO VISA outside UK days calculator</title>
  <script>
    function generateDates() {
      var numTrips = document.getElementById("numTrips").value;
      var container = document.getElementById("datesContainer");
      container.innerHTML = "";
      for (var i = 0; i < numTrips; i++) {
        container.innerHTML += "Leaving Date " + (i + 1) + ": <input type='date'><br>";
        container.innerHTML += "Entering Date " + (i + 1) + ": <input type='date'><br><br>";
      }
    }
	function get12MonthsBefore(date) {
	  var twelveMonthsBefore = new Date();
	  twelveMonthsBefore.setFullYear(date.getFullYear() - 1, date.getMonth(), date.getDate());
	  return twelveMonthsBefore;
	}
    function checkDates() {
      var bnoApprovalDate = new Date(document.getElementById("bnoApprovalDate").value);
      var datesContainer = document.getElementById("datesContainer");
      var leaveDates = datesContainer.getElementsByClassName("leaveDate");
      var enterDates = datesContainer.getElementsByClassName("enterDate");
      var outsideUK = 0;
      var valid = true;
      var rolling12months = new Date(bnoApprovalDate.getFullYear(), bnoApprovalDate.getMonth() + 12, bnoApprovalDate.getDate());
      for (var i = 0; i < leaveDates.length; i++) {
        var leaveDate = new Date(leaveDates[i].value);
        var enterDate = new Date(enterDates[i].value);
        if (enterDate < leaveDate) {
          alert("Entering date must not be earlier than leaving date for trip " + (i + 1));
          valid = false;
          break;
        }
		//get12MonthsBefore(leaveDate
        if (leaveDate >= bnoApprovalDate && leaveDate <= rolling12months) {
          outsideUK += (leaveDate - enterDate) / (1000 * 60 * 60 * 24);
		  alert(outsideUK);
        }
      }
      if (valid) {
        if (outsideUK > 180) {
          alert("YES You have exceeded 180 days outside of the UK in the last 12 months");
        } else {
          alert("NO You have not exceeded 180 days outside of the UK in the last 12 months");
        }
      }
    }
  </script>
</head>
<body>
  <h1>BNO VISA outside UK days calculator</h1>
  <label for="bnoApprovalDate">BNO VISA Approval Date:</label>
  <input type="date" id="bnoApprovalDate"><br><br>
  <label for="numTrips">Number of Trips:</label>
  <input type="number" id="numTrips"><br><br>
  <button onclick="generateDates()">Generate Dates</button>
  <br><br>
  <div id="datesContainer"></div>
  <br><br>
  <button onclick="checkDates()">Check Dates</button>
</body>
</html>
